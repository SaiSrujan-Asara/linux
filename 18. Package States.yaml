🧠 What is a Package "State"?

In Ubuntu, every installed (or partially installed) package has a status that reflects:

Its installation state

Whether it's configured or broken

Whether it’s removed but configs still exist

If it’s marked for install/remove/hold, etc.

These states are managed by DPKG and understood by APT.

---------
🔍 Viewing Package States

Use:

dpkg -l


You’ll see output like this:

ii  curl       7.68.0-1ubuntu2.20   amd64  command line tool for transferring data
rc  nginx      1.18.0-0ubuntu1.10   amd64  high performance web server
iF  mysql      8.0.30-0ubuntu1      amd64  MySQL database server

---------
📘 DPKG Package State Codes Explained

DPKG uses two or three letters to show package states:

Format: [Desired-State][Current-State][Error-State (optional)]

🔹 1. Desired State

| Code | Meaning |
| ---- | ------- |
| `i`  | Install |
| `r`  | Remove  |
| `p`  | Purge   |


🔹 2. Current State

| Code | Meaning                       |
| ---- | ----------------------------- |
| `n`  | Not-installed                 |
| `i`  | Installed                     |
| `c`  | Config files only             |
| `u`  | Unpacked (but not configured) |
| `f`  | Failed config                 |
| `h`  | Half-installed                |
| `W`  | Trigger awaited               |
| `t`  | Trigger pending               |

🔹 3. Error State (optional)

Rare but may include:

R → Reinst-required (reinstallation needed)

🧪 Example States and What They Mean

| Code | Meaning                                                |
| ---- | ------------------------------------------------------ |
| `ii` | Package is fully installed and configured              |
| `rc` | Package removed, config files remain                   |
| `iU` | Package is unpacked but not configured                 |
| `iF` | Configuration failed during install                    |
| `hi` | Half-installed — installation was interrupted          |
| `rH` | Being removed, half-configured                         |
| `pn` | Package was purged (not installed + no configs remain) |

---------
🛠️ Commands to Explore Package States

List all installed packages:
dpkg -l

Find packages in failed or unpacked state:
dpkg -l | grep '^i[UFX]'

List removed packages with remaining config files:
dpkg -l | grep '^rc'

Check detailed info of a specific package:
dpkg -s <package>

🔧 How to Handle Common States
🔹 iU, iF, h → Use:
sudo dpkg --configure -a

🔹 rc (removed, config remains) → Clean up:
sudo apt purge <package>

🔹 Reinst-required → Try reinstalling:
sudo apt install --reinstall <package>

----------
✅ Summary

| Task                                 | Command                    |                   |
| ------------------------------------ | -------------------------- | ----------------- |
| View all packages                    | `dpkg -l`                  |                   |
| Find broken or unconfigured packages | \`dpkg -l                  | grep '^i\[UFX]'\` |
| Purge configs of removed packages    | `sudo apt purge <pkg>`     |                   |
| Reconfigure packages                 | `sudo dpkg --configure -a` |                   |
| Show detailed status                 | `dpkg -s <pkg>`            |                   |
